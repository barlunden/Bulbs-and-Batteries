---
// src/pages/login.astro
import Layout from "../layouts/Layout.astro";
export const prerender = false;

const url = new URL(Astro.request.url);
const error = url.searchParams.get("error");
const message = url.searchParams.get("message");
---

<Layout title="Logg inn">
  <div class="max-w-md mx-auto mt-12 md:mt-20">
    <main class="bg-white p-8 md:p-10 rounded-3xl shadow-xl border border-slate-100">
      <div class="mb-8">
        <h1 class="text-3xl font-black text-slate-900 tracking-tight mb-2">
          Velkommen
        </h1>
        <p class="text-slate-500 italic text-sm">
          Logg inn eller opprett konto for å få tilgang.
        </p>
      </div>

      {error && (
        <div class="bg-red-50 border-2 border-red-200 p-4 rounded-2xl mb-6">
          <div class="flex items-center gap-2">
            <span class="text-red-600 text-xl">⚠️</span>
            <p class="text-red-800 font-bold text-sm">{decodeURIComponent(error)}</p>
          </div>
        </div>
      )}

      {message && (
        <div class="bg-emerald-50 border-2 border-emerald-200 p-4 rounded-2xl mb-6">
          <div class="flex items-center gap-2">
            <span class="text-emerald-600 text-xl">✓</span>
            <p class="text-emerald-800 font-bold text-sm">{decodeURIComponent(message)}</p>
          </div>
        </div>
      )}

      <div class="space-y-4">
        <form action="/api/auth/signin" method="POST" class="space-y-4">
          <div class="space-y-3">
            <div>
              <label class="block text-[10px] font-black uppercase text-slate-400 mb-1">E-post</label>
              <input type="email" name="email" required class="w-full border-2 border-slate-100 rounded-xl px-4 py-3" />
            </div>
            <div>
              <label class="block text-[10px] font-black uppercase text-slate-400 mb-1">Passord</label>
              <input type="password" name="password" required class="w-full border-2 border-slate-100 rounded-xl px-4 py-3" />
            </div>
          </div>
          
          <button 
            type="submit" 
            class="w-full bg-indigo-600 text-white font-black py-4 rounded-2xl hover:bg-indigo-500 hover:shadow-lg hover:shadow-indigo-200 transition-all active:scale-[0.98]"
          >
            LOGG INN
          </button>
        </form>

        <div class="relative">
          <div class="absolute inset-0 flex items-center">
            <div class="w-full border-t border-slate-200"></div>
          </div>
          <div class="relative flex justify-center text-xs uppercase">
            <span class="bg-white px-2 text-slate-400 font-bold">Eller</span>
          </div>
        </div>

        <form action="/api/auth/signup" method="POST" class="space-y-4">
          <div class="space-y-3">
            <div>
              <label class="block text-[10px] font-black uppercase text-slate-400 mb-1">E-post</label>
              <input type="email" name="email" required class="w-full border-2 border-slate-100 rounded-xl px-4 py-3" />
            </div>
            <div>
              <label class="block text-[10px] font-black uppercase text-slate-400 mb-1">Passord</label>
              <input type="password" name="password" required minlength="6" class="w-full border-2 border-slate-100 rounded-xl px-4 py-3" />
            </div>
          </div>
          
          <button 
            type="submit" 
            class="w-full bg-slate-900 text-white font-black py-4 rounded-2xl hover:bg-slate-800 transition-all active:scale-[0.98]"
          >
            OPPRETT KONTO
          </button>
        </form>

        <p class="text-[10px] text-center text-slate-400 uppercase font-bold tracking-tighter">
          Sikker innlogging via Supabase Auth
        </p>
      </div>
    </main>
    
    <p class="text-center mt-8 text-slate-400 text-xs">
      Er du vaktmester? Kontakt administrator for å bli lagt til i eit burettslag.
    </p>
  </div>
</Layout>