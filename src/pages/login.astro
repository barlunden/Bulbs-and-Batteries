---
// src/pages/login.astro
import Layout from "../layouts/Layout.astro";
export const prerender = false;

// Sjekk om vi akkurat sendte en e-post (for √• vise bekreftelse)
const url = new URL(Astro.request.url);
const sent = url.searchParams.get("sent") === "true";
---

<Layout title="Logg inn">
  <div class="max-w-md mx-auto mt-12 md:mt-20">
    <main class="bg-white p-8 md:p-10 rounded-3xl shadow-xl border border-slate-100">
      <div class="mb-8">
        <h1 class="text-3xl font-black text-slate-900 tracking-tight mb-2">
          Velkommen
        </h1>
        <p class="text-slate-500 italic text-sm">
          Logg inn for √• f√• tilgang til oversikta over lysp√¶rer og batteri.
        </p>
      </div>

      {sent ? (
        <div class="bg-emerald-50 border border-emerald-200 p-6 rounded-2xl text-center">
          <div class="text-3xl mb-3">üì©</div>
          <h2 class="text-emerald-800 font-bold mb-1">Magic Link er sendt!</h2>
          <p class="text-emerald-700 text-sm">Sjekk e-posten din og klikk p√• lenka for √• logge inn.</p>
          <a href="/login" class="inline-block mt-4 text-xs font-bold text-emerald-600 underline">Pr√∏v igjen?</a>
        </div>
      ) : (
        <form action="/api/auth/signin" method="POST" class="space-y-6">
          <div class="space-y-4">
  <div>
    <label class="block text-[10px] font-black uppercase text-slate-400 mb-1">E-post</label>
    <input type="email" name="email" required class="w-full border-2 border-slate-100 rounded-xl px-4 py-3" />
  </div>
  <div>
    <label class="block text-[10px] font-black uppercase text-slate-400 mb-1">Passord</label>
    <input type="password" name="password" required class="w-full border-2 border-slate-100 rounded-xl px-4 py-3" />
  </div>
  <button type="submit" class="w-full bg-indigo-600 text-white font-black py-4 rounded-2xl">
    LOGG INN
  </button>
</div>
          
          <button 
            type="submit" 
            class="w-full bg-slate-900 text-white font-black py-4 rounded-2xl hover:bg-indigo-600 hover:shadow-lg hover:shadow-indigo-200 transition-all active:scale-[0.98]"
          >
            SEND MAGIC LINK
          </button>

          <p class="text-[10px] text-center text-slate-400 uppercase font-bold tracking-tighter">
            Ingen passord trengs ‚Ä¢ Trygt og enkelt
          </p>
        </form>
      )}
    </main>
    
    <p class="text-center mt-8 text-slate-400 text-xs">
      Er du vaktmester? Kontakt administrator for √• bli lagt til i eit burettslag.
    </p>
  </div>
</Layout>