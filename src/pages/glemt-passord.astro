---
// src/pages/glemt-passord.astro
import Layout from "../layouts/Layout.astro";
export const prerender = false;

const url = new URL(Astro.request.url);
const error = url.searchParams.get("error");
const message = url.searchParams.get("message");
---

<Layout title="Glemt passord">
  <div class="max-w-md mx-auto mt-12 md:mt-20">
    <main class="bg-white p-8 md:p-10 rounded-3xl shadow-xl border border-slate-100">
      <div class="mb-8">
        <h1 class="text-3xl font-black text-slate-900 tracking-tight mb-2">
          Glemt passord?
        </h1>
        <p class="text-slate-500 italic text-sm">
          Skriv inn e-postadressa di, så sender vi deg ei lenke for å tilbakestille passordet.
        </p>
      </div>

      {error && (
        <div class="bg-red-50 border-2 border-red-200 p-4 rounded-2xl mb-6">
          <div class="flex items-center gap-2">
            <span class="text-red-600 text-xl">⚠️</span>
            <p class="text-red-800 font-bold text-sm">{decodeURIComponent(error)}</p>
          </div>
        </div>
      )}

      {message && (
        <div class="bg-emerald-50 border-2 border-emerald-200 p-4 rounded-2xl mb-6">
          <div class="flex items-center gap-2">
            <span class="text-emerald-600 text-xl">✓</span>
            <p class="text-emerald-800 font-bold text-sm">{decodeURIComponent(message)}</p>
          </div>
        </div>
      )}

      <form action="/api/auth/reset-password" method="POST" class="space-y-4">
        <div>
          <label class="block text-[10px] font-black uppercase text-slate-400 mb-1">E-post</label>
          <input 
            type="email" 
            name="email" 
            required 
            class="w-full border-2 border-slate-100 rounded-xl px-4 py-3"
            placeholder="din@epost.no"
          />
        </div>
        
        <button 
          type="submit" 
          class="w-full bg-indigo-600 text-white font-black py-4 rounded-2xl hover:bg-indigo-500 hover:shadow-lg hover:shadow-indigo-200 transition-all active:scale-[0.98]"
        >
          SEND TILBAKESTILLINGSLENKE
        </button>
      </form>

      <div class="mt-6 pt-6 border-t border-slate-200 text-center">
        <p class="text-sm text-slate-600">
          Hugsa passordet likevel? <a href="/login" class="font-bold text-indigo-600 hover:text-indigo-500 transition-colors">Logg inn her</a>
        </p>
      </div>

      <p class="text-[10px] text-center text-slate-400 uppercase font-bold tracking-tighter mt-6">
        Sikker passord-reset via Supabase Auth
      </p>
    </main>

    <div class="max-w-md mx-auto mt-8 p-4 bg-amber-50 rounded-2xl border border-amber-100">
      <p class="text-xs text-slate-600 text-center">
        <strong class="text-slate-900">Tips:</strong> Sjekk søppelpost-mappa om du ikkje får e-posten innan nokre minutt.
      </p>
    </div>
  </div>
</Layout>
